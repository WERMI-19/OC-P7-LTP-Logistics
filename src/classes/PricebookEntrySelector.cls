public with sharing class PricebookEntrySelector { public static List<PricebookEntry> listActiveByZone(String zoneCodeOpt){ String z = (zoneCodeOpt==null)?null:zoneCodeOpt.trim(); String soql='SELECT Id, UnitPrice, IsActive, ZoneCode__c, LeadTimeDays__c, Pricebook2Id, Pricebook2.IsActive, Product2Id, Product2.Name, Product2.ServiceLevel__c, Product2.Carrier__c, Product2.Carrier__r.Name FROM PricebookEntry WHERE IsActive = true AND Pricebook2.IsActive = true'; if(z!=null && z!=''){ soql += ' AND ZoneCode__c = :z'; return Database.query(soql);} return Database.query(soql);} }